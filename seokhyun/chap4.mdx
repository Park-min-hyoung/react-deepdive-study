---
title: 04장 정리
date: '2024/04/25'
description: 서버 사이드 렌더링 - SSR
---

## 서버사이드 렌더링 이란?

    - 서버사이드 렌더링은 사용자가 웹사이트에 방문했을 때 서버에서 HTML을 만들어서 사용자에게 보내주는 방식이다.
    - 웹페이지가 느려지는 상황에 대한 문제를 SPA의 태생적 한계에서 찾고, 이를 개선하기 위해 SSR이 다시 유행중이다.

## 서버사이드 렌더링의 장점

    - 검색엔진 최적화(SEO)가 용이하다.
    - 초기 로딩 속도가 빠르다.
    - 누적 레이아웃 이동이 적다.
        - 화면이 렌더링된 이후 사용자가 상호작용 하려고할때 새로운 개체가 렌더링되어 불편을 주는것을 말한다.
        - 클릭하려고할때 갑자기 광고배너가 렌더링되어 광고페이지로 넘어가는 경우가 예시가 될 수 있다.
    - 사용자 디바이스 성능에 비교적 자유롭다.
        - 하지만 인터넷이 느리다면 마찬가지로 느려진다.
    - 보안성이 높다.
        - 서버에서 렌더링하기 때문에 클라이언트에서 노출되지 않는다.
    
## 서버사이드 렌더링의 단점

    - 소스 코드를 작성할때 항상 서버사이드 렌더링을 고려해야한다.
        - 서버사이드 렌더링을 고려하지 않으면 클라이언트에서만 렌더링되어 검색엔진 최적화가 어렵다.
        - window 등 클라이언트에서만 사용가능한 객체를 사용하면 에러가 발생한다.
        - 라이브러리를 사용할때도 SSR을 지원하는지 확인해야한다.
    - 적절한 서버가 필요하다.
        - 서버사이드 렌더링을 위해서는 서버가 필요하다.
        - 서버를 구축하고 관리하는데 비용이 발생한다.
    - 서비스 지연에 따른 문제가 발생할 수 있다.
        - 서버사이드 렌더링을 사용하면 서버에서 렌더링하기 때문에 서버의 응답속도에 따라 사용자가 웹페이지를 볼 수 있는 시간이 달라진다.
        - CSR의 경우 화면에 보여주기라도 한 후 로딩중 등의 조치를 취할 수 있지만 SSR의 경우 작업이 끝나기까지 아무것도 보여줄수 없다.

## SPA와 SSR

    - 최근에는 멀티페이지 애플리케이션에서 발생하는 라우팅으로 인한 문제를 해결하기위해 다양한 API가 브라우저에 추가되고 있다.
        - 페인트 홀딩 : 같은 출처에서 라우팅이 일어날경우 화면을 잠깐 하얗게 띄우는 대신 이전페이지의 모습을 잠깐 보여주는 기법
        - back forward cache(bfcache) : 뒤로가기, 앞으로가기를 할때 이전페이지의 캐시된 상태를 그대로 가져오는 기법
        - shared element transitions : 페이지 이동시 공통된 요소를 유지해 부드럽게 전환되게 하는 기법.

    - 프론트엔드 개발자는 서버에서의 렌더링과 클라이언트에서의 렌더링을 모두 이해해야 두가지 장점을 모두 사용하는 웹서비스를 구축할 수 있다.

- renderToString
    - 서버사이드 렌더링을 위해 사용되는 함수
    - 일단 HTML을 렌더링해준다 서버사이드 렌더링의 목적에 부합하는 메서드 이다.
    - useEffect등의 이벤트 핸들러는 별도의 자바스크립트 코드를 모두 다운로드, 파싱, 실행과정까지 거쳐야한다.

- renderToStaticMarkup
    - renderToString과 비슷하지만, 리액트 컴포넌트를 렌더링할때 생성된 DOM에 대한 정보를 제거한다.
    - 이벤트 핸들러가 필요없는 경우에 사용한다.
    ex - 이용약관 , 블로그 글 등

- renderToNodeStream
    - 브라우저에서 사용이 불가능하다.
    - ReadableStream이 결과물이라 String 형태로 변환하기위해 추가 작업이 필요하다.
    - ReadableStream자체는 브라우저 사용이 가능하지만 만드는 과정이 브라우저에서 불가능하다.
    - 서버에서 불러와야할 스트림의 크기가 매우큰경우 chunk로 나눠서 가져오는 방식이다.
    - 대부분의 리액트 SSR 라이브러리는 renderToNodeStream을 채택하고 있다.

- renderToStaticNodeStream
    - renderToNodeStream과 비슷하지만, 리액트 컴포넌트를 렌더링할때 생성된 DOM에 대한 정보를 제거한다.
    - 이벤트 핸들러가 필요없는 경우에 사용한다.
    - renderToStaticMarkup과 비슷하지만, 스트림으로 렌더링한다.

- hydrate
    - 자바스크립트 핸들러나 이벤트 핸들러를 붙이는 역할을 한다.
    - renderToStaticMarkup등으로 생성된 리액트 관련 정보가 없는 순수한 HTML을 넘겨주면 기대값이 없다고 나온다.
    